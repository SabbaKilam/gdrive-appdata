!function(e){var t=function(){var e=a.config.silentAuth;return a.config.silentAuth=!0,gapi.auth.authorize({client_id:a.config.clientId,scope:a.config.scope,immediate:e}).then(function(){if(!gapi.auth.getToken())throw"authFailed"},function(){if(a.config.silentAuth)throw a.config.silentAuth=!1,"silentAuthFailed"})},i=function(){return t().then(function(){return gapi.client.load("drive","v3")}).then(function(){if(!gapi.client.drive)throw"driveAPILoadFailed"})},n=function(){return i().then(function(){return gapi.client.drive.files.list({q:'name="'+a.config.appDataFileName+'"',spaces:"appDataFolder",fields:"files(id)"}).then(function(e){return e&&e.result&&e.result.files&&e.result.files.length>0&&e.result.files[0].id?e.result.files[0].id:gapi.client.drive.files.create({fields:"id",resource:{name:a.config.appDataFileName,parents:["appDataFolder"]}}).then(function(e){if(e&&e.result&&e.result.id)return e.result.id;throw"appDataCreateFailed"})})})},a={config:{appDataFileName:"my-app-data.json",silentAuth:!0,clientId:null,scope:"https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.appdata"},loadAppData:function(){return n().then(function(e){return gapi.client.drive.files.get({fileId:e,alt:"media"}).then(function(e){return e.result})})},saveAppData:function(e){return n().then(function(t){return gapi.client.request({path:"/upload/drive/v3/files/"+t,method:"PATCH",params:{uploadType:"media"},body:JSON.stringify(e)})})}};e.GDriveAppData=a}(this);